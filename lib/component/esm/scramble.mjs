import{s as e}from"./typingInterval.mjs";let n=[];const t=e=>n.find((n=>n.currentNode===e)),r=e=>{const n=(e=>{const n=/(<([^>]+)>)/g,t=[];let r;for(;null!==(r=n.exec(e.innerHTML));){const e=r.index,o=n.lastIndex;t.push([e,o-1])}return t})(e),r=e.innerHTML.split("").map(((r,o)=>{const{matchingLetters:s}=t(e),a=s.includes(o)||r.match(/\s+/g)||((e,n)=>n.some((([n,t])=>((e,[n,t])=>e>=n&&e<=t)(e,[n,t]))))(o,n),c=String.fromCharCode(65+Math.round(50*Math.random()));return a?r:c})).join("");e.innerHTML=r},o=(e,n)=>{const r=e.innerHTML;for(let o=0;o<n.length;o++){const s=n[o],{matchingLetters:a}=t(e);!a.includes(o)&&s===r[o]&&a.push(o)}};export default async({elements:t},s)=>{n=[...t.map((({currentNode:e})=>({currentNode:e,matchingLetters:[]})))],await new Promise((n=>{t.forEach((async({currentNode:t,text:a})=>{const c="number"==typeof s.scramble?s.scramble:3e3,i=(new Date).getTime();for(;;){r(t),o(t,a),await e(s.interval);const m=t.innerHTML!=a,l=(new Date).getTime()-i<c;if(!m||!l){n();break}}t.innerHTML=a}))})),s.dispatch("done")};
